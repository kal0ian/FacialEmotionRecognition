model = Sequential()

model.add(Conv2D(filters = 32, kernel_size = (3, 3), activation='relu',
                 input_shape = (48, 48, 1)))
model.add(BatchNormalization())
model.add(Conv2D(filters = 64, kernel_size = (3, 3), activation='relu'))
model.add(BatchNormalization())
model.add(MaxPool2D(strides=(2,2)))
model.add(Dropout(0.25))

model.add(Conv2D(filters = 64, kernel_size = (3, 3), activation='relu'))
model.add(BatchNormalization())
model.add(Conv2D(filters = 64, kernel_size = (3, 3), activation='relu'))
model.add(BatchNormalization())
model.add(MaxPool2D(strides=(2,2)))
model.add(Dropout(0.25))

model.add(Flatten())
model.add(Dense(512, activation='relu'))
model.add(Dropout(0.25))
model.add(Dense(1024, activation='relu'))
model.add(Dropout(0.5))
model.add(Dense(7, activation='softmax'))

20epochs - third_model

Epoch 1/20
500/500 [==============================] - 566s 1s/step - loss: 2.0767 - acc: 0.2296 - val_loss: 1.8413 - val_acc: 0.2475
Epoch 2/20
500/500 [==============================] - 545s 1s/step - loss: 1.8250 - acc: 0.2561 - val_loss: 1.8171 - val_acc: 0.2575
Epoch 3/20
500/500 [==============================] - 517s 1s/step - loss: 1.7720 - acc: 0.2664 - val_loss: 1.6444 - val_acc: 0.3250
Epoch 4/20
500/500 [==============================] - 519s 1s/step - loss: 1.7302 - acc: 0.2794 - val_loss: 1.6635 - val_acc: 0.3325
Epoch 5/20
500/500 [==============================] - 520s 1s/step - loss: 1.7022 - acc: 0.3096 - val_loss: 1.6893 - val_acc: 0.3400
Epoch 6/20
500/500 [==============================] - 522s 1s/step - loss: 1.6678 - acc: 0.3255 - val_loss: 1.7818 - val_acc: 0.3025
Epoch 7/20
500/500 [==============================] - 518s 1s/step - loss: 1.6263 - acc: 0.3387 - val_loss: 1.6029 - val_acc: 0.3650
Epoch 8/20
500/500 [==============================] - 519s 1s/step - loss: 1.6035 - acc: 0.3518 - val_loss: 1.5396 - val_acc: 0.4025
Epoch 9/20
500/500 [==============================] - 517s 1s/step - loss: 1.5734 - acc: 0.3723 - val_loss: 1.5368 - val_acc: 0.4100
Epoch 10/20
500/500 [==============================] - 518s 1s/step - loss: 1.5569 - acc: 0.3748 - val_loss: 1.4666 - val_acc: 0.4100
Epoch 11/20
500/500 [==============================] - 519s 1s/step - loss: 1.5245 - acc: 0.3909 - val_loss: 1.4688 - val_acc: 0.4350
Epoch 12/20
500/500 [==============================] - 522s 1s/step - loss: 1.5090 - acc: 0.3998 - val_loss: 1.4291 - val_acc: 0.4550
Epoch 13/20
500/500 [==============================] - 522s 1s/step - loss: 1.5055 - acc: 0.4057 - val_loss: 1.4062 - val_acc: 0.4675
Epoch 14/20
500/500 [==============================] - 519s 1s/step - loss: 1.4849 - acc: 0.4114 - val_loss: 1.3680 - val_acc: 0.4850
Epoch 15/20
500/500 [==============================] - 519s 1s/step - loss: 1.4677 - acc: 0.4186 - val_loss: 1.3507 - val_acc: 0.4725
Epoch 16/20
500/500 [==============================] - 519s 1s/step - loss: 1.4483 - acc: 0.4373 - val_loss: 1.3194 - val_acc: 0.4775
Epoch 17/20
500/500 [==============================] - 520s 1s/step - loss: 1.4445 - acc: 0.4404 - val_loss: 1.3165 - val_acc: 0.5200
Epoch 18/20
500/500 [==============================] - 520s 1s/step - loss: 1.4239 - acc: 0.4361 - val_loss: 1.2942 - val_acc: 0.4875
Epoch 19/20
500/500 [==============================] - 520s 1s/step - loss: 1.4161 - acc: 0.4465 - val_loss: 1.2803 - val_acc: 0.5300
Epoch 20/20
500/500 [==============================] - 524s 1s/step - loss: 1.3829 - acc: 0.4604 - val_loss: 1.2601 - val_acc: 0.5425

40epochs - fourth model


Epoch 21/40
500/500 [==============================] - 516s 1s/step - loss: 1.3772 - acc: 0.4612 - val_loss: 1.2512 - val_acc: 0.5450
Epoch 22/40
500/500 [==============================] - 520s 1s/step - loss: 1.3944 - acc: 0.4564 - val_loss: 1.2297 - val_acc: 0.5475
Epoch 23/40
500/500 [==============================] - 521s 1s/step - loss: 1.3660 - acc: 0.4641 - val_loss: 1.2258 - val_acc: 0.5600
Epoch 24/40
500/500 [==============================] - 520s 1s/step - loss: 1.3788 - acc: 0.4586 - val_loss: 1.2210 - val_acc: 0.5400
Epoch 25/40
500/500 [==============================] - 520s 1s/step - loss: 1.3569 - acc: 0.4647 - val_loss: 1.2043 - val_acc: 0.5500
Epoch 26/40
500/500 [==============================] - 520s 1s/step - loss: 1.3376 - acc: 0.4768 - val_loss: 1.1927 - val_acc: 0.5500
Epoch 27/40
500/500 [==============================] - 519s 1s/step - loss: 1.3527 - acc: 0.4777 - val_loss: 1.1985 - val_acc: 0.5525
Epoch 28/40
500/500 [==============================] - 519s 1s/step - loss: 1.3451 - acc: 0.4763 - val_loss: 1.1938 - val_acc: 0.5525
Epoch 29/40
500/500 [==============================] - 519s 1s/step - loss: 1.3470 - acc: 0.4751 - val_loss: 1.1806 - val_acc: 0.5675
Epoch 30/40
500/500 [==============================] - 519s 1s/step - loss: 1.3217 - acc: 0.4913 - val_loss: 1.1755 - val_acc: 0.5750
Epoch 31/40
500/500 [==============================] - 519s 1s/step - loss: 1.3011 - acc: 0.4933 - val_loss: 1.1689 - val_acc: 0.5725
Epoch 32/40
500/500 [==============================] - 519s 1s/step - loss: 1.3199 - acc: 0.4818 - val_loss: 1.1643 - val_acc: 0.5750
Epoch 33/40
500/500 [==============================] - 518s 1s/step - loss: 1.3092 - acc: 0.4975 - val_loss: 1.1581 - val_acc: 0.5750
Epoch 34/40
500/500 [==============================] - 518s 1s/step - loss: 1.3100 - acc: 0.4931 - val_loss: 1.1604 - val_acc: 0.5800
Epoch 35/40
500/500 [==============================] - 518s 1s/step - loss: 1.3185 - acc: 0.4879 - val_loss: 1.1550 - val_acc: 0.5775
Epoch 36/40
500/500 [==============================] - 519s 1s/step - loss: 1.2964 - acc: 0.4971 - val_loss: 1.1609 - val_acc: 0.5775
Epoch 37/40
500/500 [==============================] - 519s 1s/step - loss: 1.3067 - acc: 0.4934 - val_loss: 1.1560 - val_acc: 0.5875
Epoch 38/40
500/500 [==============================] - 517s 1s/step - loss: 1.2998 - acc: 0.4890 - val_loss: 1.1521 - val_acc: 0.5775
Epoch 39/40
500/500 [==============================] - 520s 1s/step - loss: 1.2873 - acc: 0.5050 - val_loss: 1.1445 - val_acc: 0.5800
Epoch 40/40
500/500 [==============================] - 517s 1s/step - loss: 1.3023 - acc: 0.4958 - val_loss: 1.1462 - val_acc: 0.5850